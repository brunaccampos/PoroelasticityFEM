function Quad = getIPs(nsd, nq, type)
% Return quadrature coordinates and weights
%   --------------------------------------------------------------------
%   References
%   --------------------------------------------------------------------
%   [1] Fish, J., & Belytschko, T. (2007). A first course in finite
%       elements. Chichester; Hoboken, NJ: John Wiley & Sons.
%   --------------------------------------------------------------------
%   Adapted from: https://github.com/GCMLab (Acknowledgements: Jack Chessa)
%   --------------------------------------------------------------------

switch type
    case {'T3', 'T6'}
        %% 2D triangular elements
        % quadrature coordinates
        Quad.p = zeros(nq,nsd);
        % quadrature weights
        Quad.w = zeros(nq,1);
        switch nq
            case 1
                % coords
                Quad.p(1) = [1/3, 1/3];
                % weight
                Quad.w(1) = 1;
            case 3
                % coords
                Quad.p(1,:) = [1/6, 1/6];
                Quad.p(2,:) = [2/3, 1/6];
                Quad.p(3,:) = [1/6, 2/3];
                % weights
                Quad.w(:) = 1/3;
            case 7
                % coords
                Quad.p(1,:) = [0.1012865073235, 0.1012865073235];
                Quad.p(2,:) = [0.7974269853531, 0.1012865073235];
                Quad.p(3,:) = [0.1012865073235, 0.7974269853531];
                Quad.p(4,:) = [0.4701420641051, 0.0597158717898];
                Quad.p(5,:) = [0.4701420641051, 0.4701420641051];
                Quad.p(6,:) = [0.0597158717898, 0.4701420641051];
                Quad.p(7,:) = [1/3, 1/3];
                % weights
                Quad.w(1) = 0.1259391805448;
                Quad.w(2) = 0.1259391805448;
                Quad.w(3) = 0.1259391805448;
                Quad.w(4) = 0.1323941527885;
                Quad.w(5) = 0.1323941527885;
                Quad.w(6) = 0.1323941527885;
                Quad.w(7) = 0.225;
        end
    otherwise
        %% 1D and 2D quadrilateral elements
        % quadrature coordinates
        Quad.p = zeros(nq^nsd,nsd);
        % quadratrure weights
        Quad.w = zeros(nq^nsd,1);
        
        pt = zeros(nq,1);
        wt = zeros(nq,1);
        switch nq
            case 1
                % coords
                pt(1) = 0;
                % weights
                wt(1) = 2;
            case 2
                % coords
                pt(1) = 0.577350269189626;
                pt(2) = -0.577350269189626;
                % weights
                wt(:) = 1;
            case 3
                % coords
                pt(1) =  0.774596669241483;
                pt(2) = -0.774596669241483;
                pt(3) =  0.000000000000000;
                % weights
                wt(1) = 0.555555555555556;
                wt(2) = 0.555555555555556;
                wt(3) = 0.888888888888889;
            case 4
                % coords
                pt(1) =  0.861134311594053;
                pt(2) = -0.861134311594053;
                pt(3) =  0.339981043584856;
                pt(4) = -0.339981043584856;
                % weights
                wt(1) = 0.347854845137454;
                wt(2) = 0.347854845137454;
                wt(3) = 0.652145154862546;
                wt(4) = 0.652145154862546;
            case 5
                % coords
                pt(1) =  0.906179845938664;
                pt(2) = -0.906179845938664;
                pt(3) =  0.538469310105683;
                pt(4) = -0.538469310105683;
                pt(5) =  0.000000000000000;
                % weights
                wt(1) = 0.236926885056189;
                wt(2) = 0.236926885056189;
                wt(3) = 0.478628670499366;
                wt(4) = 0.478628670499366;
                wt(5) = 0.568888888888889;
            case 6
                % coords
                pt(1) =  0.932469514203152;
                pt(2) = -0.932469514203152;
                pt(3) =  0.661209386466265;
                pt(4) = -0.661209386466265;
                pt(5) =  0.238619186003152;
                pt(6) = -0.238619186003152;
                % weights
                wt(1) = 0.171324492379170;
                wt(2) = 0.171324492379170;
                wt(3) = 0.360761573048139;
                wt(4) = 0.360761573048139;
                wt(5) = 0.467913934572691;
                wt(6) = 0.467913934572691;
            case 7
                % coords
                pt(1) =  0.949107912342759;
                pt(2) = -0.949107912342759;
                pt(3) =  0.741531185599394;
                pt(4) = -0.741531185599394;
                pt(5) =  0.405845151377397;
                pt(6) = -0.405845151377397;
                pt(7) =  0.000000000000000;
                % weights
                wt(1) = 0.129484966168870;
                wt(2) = 0.129484966168870;
                wt(3) = 0.279705391489277;
                wt(4) = 0.279705391489277;
                wt(5) = 0.381830050505119;
                wt(6) = 0.381830050505119;
                wt(7) = 0.417959183673469;
            case 8
                % coords
                pt(1) =  0.960289856497536;
                pt(2) = -0.960289856497536;
                pt(3) =  0.796666477413627;
                pt(4) = -0.796666477413627;
                pt(5) =  0.525532409916329;
                pt(6) = -0.525532409916329;
                pt(7) =  0.183434642495650;
                pt(8) = -0.183434642495650;
                % weights
                wt(1) = 0.101228536290376;
                wt(2) = 0.101228536290376;
                wt(3) = 0.222381034453374;
                wt(4) = 0.222381034453374;
                wt(5) = 0.313706645877887;
                wt(6) = 0.313706645877887;
                wt(7) = 0.362683783378362;
                wt(8) = 0.362683783378362;
            case 9
                % coords
                pt(1) =  0.0000000000000000;
                pt(2) = -0.8360311073266358;
                pt(3) =  0.8360311073266358;
                pt(4) = -0.9681602395076261;
                pt(5) =  0.9681602395076261;
                pt(6) = -0.3242534234038089;
                pt(7) =  0.3242534234038089;
                pt(8) = -0.6133714327005904;
                pt(9) =  0.6133714327005904;
                % weights
                wt(1) = 0.3302393550012598;
                wt(2) = 0.1806481606948574;
                wt(3) = 0.1806481606948574;
                wt(4) = 0.0812743883615744;
                wt(5) = 0.0812743883615744;
                wt(6) = 0.3123470770400029;
                wt(7) = 0.3123470770400029;
                wt(8) = 0.2606106964029354;
                wt(9) = 0.2606106964029354;
            case 10
                % coords
                pt(1) = -0.1488743389816312;
                pt(2) =  0.1488743389816312;
                pt(3) = -0.4333953941292472;
                pt(4) =  0.4333953941292472;
                pt(5) = -0.6794095682990244;
                pt(6) =  0.6794095682990244;
                pt(7) = -0.8650633666889845;
                pt(8) =  0.8650633666889845;
                pt(9) = -0.9739065285171717;
                pt(10) = 0.9739065285171717;
                % weights
                wt(1) = 0.2955242247147529;
                wt(2) = 0.2955242247147529;
                wt(3) = 0.2692667193099963;
                wt(4) = 0.2692667193099963;
                wt(5) = 0.2190863625159820;
                wt(6) = 0.2190863625159820;
                wt(7) = 0.1494513491505806;
                wt(8) = 0.1494513491505806;
                wt(9) = 0.0666713443086881;
                wt(10) = 0.0666713443086881;
            case 11
                % coords
                pt(1) =  0.0000000000000000;
                pt(2) = -0.2695431559523450;
                pt(3) =  0.2695431559523450;
                pt(4) = -0.5190961292068118;
                pt(5) =  0.5190961292068118;
                pt(6) = -0.7301520055740494;
                pt(7) =  0.7301520055740494;
                pt(8) = -0.8870625997680953;
                pt(9) =  0.8870625997680953;
                pt(10) = -0.9782286581460570;
                pt(11) =  0.9782286581460570;
                % weights
                wt(1) = 0.2729250867779006;
                wt(2) = 0.2628045445102467;
                wt(3) = 0.2628045445102467;
                wt(4) = 0.2331937645919905;
                wt(5) = 0.2331937645919905;
                wt(6) = 0.1862902109277343;
                wt(7) = 0.1862902109277343;
                wt(8) = 0.1255803694649046;
                wt(9) = 0.1255803694649046;
                wt(10) = 0.0556685671161737;
                wt(11) = 0.0556685671161737;
            case 12
                % coords
                pt(1) = -0.1252334085114689;
                pt(2) =  0.1252334085114689;
                pt(3) = -0.3678314989981802;
                pt(4) =  0.3678314989981802;
                pt(5) = -0.5873179542866175;
                pt(6) =  0.5873179542866175;
                pt(7) = -0.7699026741943047;
                pt(8) =  0.7699026741943047;
                pt(9) = -0.9041172563704749;
                pt(10) = 0.9041172563704749;
                pt(11) = -0.9815606342467192;
                pt(12) =  0.9815606342467192;
                % weights
                wt(1) = 0.2491470458134028;
                wt(2) = 0.2491470458134028;
                wt(3) = 0.2334925365383548;
                wt(4) = 0.2334925365383548;
                wt(5) = 0.2031674267230659;
                wt(6) = 0.2031674267230659;
                wt(7) = 0.1600783285433462;
                wt(8) = 0.1600783285433462;
                wt(9) = 0.1069393259953184;
                wt(10) = 0.1069393259953184;
                wt(11) = 0.0471753363865118;
                wt(12) = 0.0471753363865118;
            case 13
                % coords
                pt(1) =  0.0000000000000000;
                pt(2) = -0.2304583159551348;
                pt(3) =  0.2304583159551348;
                pt(4) = -0.4484927510364469;
                pt(5) =  0.4484927510364469;
                pt(6) = -0.6423493394403402;
                pt(7) =  0.6423493394403402;
                pt(8) = -0.8015780907333099;
                pt(9) =  0.8015780907333099;
                pt(10) = -0.9175983992229779;
                pt(11) =  0.9175983992229779;
                pt(12) = -0.9841830547185881;
                pt(13) =  0.9841830547185881;
                % weights
                wt(1) = 0.2325515532308739;
                wt(2) = 0.2262831802628972;
                wt(3) = 0.2262831802628972;
                wt(4) = 0.2078160475368885;
                wt(5) = 0.2078160475368885;
                wt(6) = 0.1781459807619457;
                wt(7) = 0.1781459807619457;
                wt(8) = 0.1388735102197872;
                wt(9) = 0.1388735102197872;
                wt(10) = 0.0921214998377285;
                wt(11) = 0.0921214998377285;
                wt(12) = 0.0404840047653159;
                wt(13) = 0.0404840047653159;
            case 14
                % coords
                pt(1) = -0.1080549487073437;
                pt(2) =  0.1080549487073437;
                pt(3) = -0.3191123689278897;
                pt(4) =  0.3191123689278897;
                pt(5) = -0.5152486363581541;
                pt(6) =  0.5152486363581541;
                pt(7) = -0.6872929048116855;
                pt(8) =  0.6872929048116855;
                pt(9) = -0.8272013150697650;
                pt(10) =  0.8272013150697650;
                pt(11) = -0.9284348836635735;
                pt(12) =  0.9284348836635735;
                pt(13) = -0.9862838086968123;
                pt(14) =  0.9862838086968123;
                % weights
                wt(1) = 0.2152638534631578;
                wt(2) = 0.2152638534631578;
                wt(3) = 0.2051984637212956;
                wt(4) = 0.2051984637212956;
                wt(5) = 0.1855383974779378;
                wt(6) = 0.1855383974779378;
                wt(7) = 0.1572031671581935;
                wt(8) = 0.1572031671581935;
                wt(9) = 0.1215185706879032;
                wt(10) = 0.1215185706879032;
                wt(11) = 0.0801580871597602;
                wt(12) = 0.0801580871597602;
                wt(13) = 0.0351194603317519;
                wt(14) = 0.0351194603317519;
            case 15
                % coords
                pt(1) =  0.0000000000000000;
                pt(2) = -0.2011940939974345;
                pt(3) =  0.2011940939974345;
                pt(4) = -0.3941513470775634;
                pt(5) =  0.3941513470775634;
                pt(6) = -0.5709721726085388;
                pt(7) =  0.5709721726085388;
                pt(8) = -0.7244177313601701;
                pt(9) =  0.7244177313601701;
                pt(10) = -0.8482065834104272;
                pt(11) =  0.8482065834104272;
                pt(12) = -0.9372733924007060;
                pt(13) =  0.9372733924007060;
                pt(14) = -0.9879925180204854;
                pt(15) =  0.9879925180204854;
                % weights
                wt(1) = 0.2025782419255613;
                wt(2) = 0.1984314853271116;
                wt(3) = 0.1984314853271116;
                wt(4) = 0.1861610000155622;
                wt(5) = 0.1861610000155622;
                wt(6) = 0.1662692058169939;
                wt(7) = 0.1662692058169939;
                wt(8) = 0.1395706779261543;
                wt(9) = 0.1395706779261543;
                wt(10) = 0.1071592204671719;
                wt(11) = 0.1071592204671719;
                wt(12) = 0.0703660474881081;
                wt(13) = 0.0703660474881081;
                wt(14) = 0.0307532419961173;
                wt(15) = 0.0307532419961173;
            case 16
                % coords
                pt(1) = -0.0950125098376374;
                pt(2) =  0.0950125098376374;
                pt(3) = -0.2816035507792589;
                pt(4) =  0.2816035507792589;
                pt(5) = -0.4580167776572274;
                pt(6) =  0.4580167776572274;
                pt(7) = -0.6178762444026438;
                pt(8) =  0.6178762444026438;
                pt(9) = -0.7554044083550030;
                pt(10) =  0.7554044083550030;
                pt(11) = -0.8656312023878318;
                pt(12) =  0.8656312023878318;
                pt(13) = -0.9445750230732326;
                pt(14) =  0.9445750230732326;
                pt(15) = -0.9894009349916499;
                pt(16) =  0.9894009349916499;
                % weights
                wt(1) = 0.1894506104550685;
                wt(2) = 0.1894506104550685;
                wt(3) = 0.1826034150449236;
                wt(4) = 0.1826034150449236;
                wt(5) = 0.1691565193950025;
                wt(6) = 0.1691565193950025;
                wt(7) = 0.1495959888165767;
                wt(8) = 0.1495959888165767;
                wt(9) = 0.1246289712555339;
                wt(10) = 0.1246289712555339;
                wt(11) = 0.0951585116824928;
                wt(12) = 0.0951585116824928;
                wt(13) = 0.0622535239386479;
                wt(14) = 0.0622535239386479;
                wt(15) = 0.0271524594117541;
                wt(16) = 0.0271524594117541;
        end
end
n = 1; % counter

% store points according to the spatial dimension
if strcmp(type,'T3') == 0 && strcmp(type,'T6') == 0
    if(nsd == 1)
        Quad.p = pt;
        Quad.w = wt;
    elseif(nsd == 2)
        for i = 1:nq
            for j = 1:nq
                Quad.p(n,:) = [pt(i,1), pt(j,1)];
                Quad.w(n) = wt(i,1)*wt(j,1);
                n = n+1;
            end
        end
    end
end

end